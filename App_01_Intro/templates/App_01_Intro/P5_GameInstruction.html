{% extends "otree/Page.html" %}
{% load staticfiles %}

{# --- 共通CSS/JSの読み込み --- #}
{% block styles %}
  <link rel="stylesheet" href="{% static 'common.css' %}">
  <style>
    .content-area h4 {
        font-size: 1.1em;
        color: #000000;
        margin-top: 24px;
        margin-bottom: 8px;
        border-left: 4px solid #3B95C4;
        padding-left: 8px;
    }
  </style>
{% endblock %}

{% block scripts %}
  <script src="{% static 'common.js' %}"></script>
{% endblock %}

{# --- ページのタイトル --- #}
{% block title %}
  お返しゲーム説明
{% endblock %}

{# --- ページのメインコンテンツ --- #}
{% block content %}

  {# SVGアイコンの定義 (oTreeの `content` 内に書く) #}
  <svg class="icon-svg">
    <symbol id="icon-person" viewBox="0 0 24 24">
      <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
    </symbol>
  </svg>

  <div class="experiment-container">
    
    <div class="progress-tabs">
      <div class="tab-button active">実験の進捗</div>
    </div>

    <div class="progress-content">
      <div class="progress-steps active" id="steps-role2">
        <div class="step completed"><div class="step-number">1</div>同意取得</div>
        <div class="step completed"><div class="step-number">2</div>実験概要説明</div>
        <div class="step completed"><div class="step-number">3</div>お返しゲーム説明</div>
        <div class="step current"><div class="step-number">4</div>タスク２説明</div>
        <div class="step"><div class="step-number">5</div>アンケート</div>
        <div class="step"><div class="step-number">6</div>報酬の確認</div>
      </div>
    </div>
    
    <div class="experiment-header">
      
      <div class="room-tabs">
        <div>作業ルーム1</div>
        <div>作業ルーム2</div>
        <div class="active">全体ルーム</div> </div>
      
      <div class="header-right-panel">
        <button type="button" class="rule-check-button" id="open-rules-modal">
          ルールを確認する
        </button>
        <div class="user-profile">
          <div class="icon icon-user">
            <svg><use xlink:href="#icon-person"></use></svg>
          </div>
          <span class="name">あなた</span>
        </div>
      </div>
    </div>
    
    <div class="content-area">
      <h2 id="page-title">お返しゲーム</h2>

      <p>
        お返しゲームは相手と協力するのかを考えながら、<strong>多くのポイントを獲得する</strong>ことを目指すゲームです。
        このゲームでは、プレイヤーは贈り物を贈る人と、贈り物を返礼する人に分かれてプレイします。
      </p>

      <div class="rule-box">
        <h3>【お返しゲームのルール】</h3>
        <p>
          ゲームは二人一組で行われます。<br>
          ゲームが始まるごとにプレイヤーは 1000pt を渡されます。
          <p>
        <p><h4>ステップ１</h4>
          贈り物を渡す側の人は、渡された1000ポイントのうち相手に何ポイント贈るのかを決めます。<br>
          <strong>ポイントは３倍になって</strong>お返しをする人に届きます。
        </p>

        <p><h4>ステップ２</h4>
          お返しをする人は、３倍になったポイントから<strong>相手にいくら返礼するのか</strong>を決めます。<br>
          相手に贈らなかったポイントは自身のものになります。
        </p>

        <p><h4>贈る人のポイント</h4>
          贈り物を渡す人は、相手が贈り物をきちんと返礼する人なのかを判断しなければなりません。<br>
          贈り物をきちんと返礼する人ならば、多くのポイントを贈り相手が返礼することで、互いに多くのポイントを獲得することができます。<br>
          つまり、相手が信頼できる人ならば、その人と<strong>協力すれば多くのポイント</strong>を獲得することができます。
        </p>
        <p><h4>返礼する人のポイント</h4>
          返礼する人は、贈られてきたポイントをすべて自分のものにすることで、ポイントを多く稼げます。<br>
          ただし相手に協力しなければ<strong>その人からは信頼されなくなります</strong>。
      </div>
    
      <p>
        それでは実際にお返しゲームを練習してみましょう。
      </p>
    </div>
    
    <div class="navigation-footer">
      {% next_button %}
    </div>

  </div>

  <div class="modal-overlay" id="rules-modal">
    <div class="modal-content">
      <div class="modal-header">
        <span>ルール確認</span>
        <button class="close-button" id="close-rules-modal">&times;</button>
      </div>
      <div class="modal-body" id="rules-modal-body">
        <p>（現在、確認できるルールはありません）</p>
      </div>
    </div>
  </div>

{% endblock %}